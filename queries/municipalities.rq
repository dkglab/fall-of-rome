PREFIX xyz: <http://sparql.xyz/facade-x/data/>
PREFIX fx: <http://sparql.xyz/facade-x/ns/>
PREFIX for: <https://dkglab.github.io/ns/for/>
PREFIX geo: <http://www.opengis.net/ont/geosparql#>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
PREFIX pno: <http://linked.data.gov.au/def/placenames/>
PREFIX dcterms: <http://purl.org/dc/terms/>

CONSTRUCT {
  ?MunicipalityURI a pno:Place ;
        pno:hasPlaceName ?Municipality ;
        dcterms:identifier ?municipality_wiki_uri .
}

WHERE {
  SERVICE <x-sparql-anything:> {
    fx:properties fx:csv.headers "true" .

    ?row xyz:Municipality ?Municipality ;
         xyz:municipality_wiki_uri ?municipality_wiki_uri .

    # Encode Municipality name for URI safety
  BIND(STR(?Municipality) AS ?id)
    # Mint new URIs using the fx:entity function
  BIND(fx:entity("https://dkglab.github.io/ns/for/", "Municipality/", ?id) AS ?MunicipalityURI)  }
}